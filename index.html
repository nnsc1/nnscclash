<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>NNSC Clash</title>
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <style>
        :root { --gold: #ffd700; --blue: #00d2ff; --pink: #ff007f; --neon: #39ff14; }
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Arial Black', sans-serif; color: white; touch-action: none; }
        
        /* UI & MENU */
        #menu-screen {
            position: absolute; width: 100%; height: 100%;
            background: radial-gradient(circle, #1a1a2e 0%, #000 100%);
            display: flex; flex-direction: column; align-items: center; z-index: 100; overflow-y: auto; padding-bottom: 40px;
        }
        .header { font-size: 3.5rem; font-style: italic; color: var(--blue); text-shadow: 4px 4px var(--pink); margin: 20px 0; }
        .selection-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; width: 95%; max-width: 600px; }
        .slot { background: rgba(255,255,255,0.05); border: 2px solid var(--blue); border-radius: 12px; padding: 10px; text-align: center; }
        .selector { display: flex; align-items: center; justify-content: space-between; margin: 5px 0; }
        .arrow { background: var(--blue); border: none; color: white; padding: 10px; border-radius: 5px; font-weight: bold; width: 40px; }
        .name-display { font-size: 1rem; font-weight: bold; overflow: hidden; white-space: nowrap; }
        .stars { color: var(--gold); font-size: 1.1rem; }
        
        #start-btn { 
            margin-top: 20px; padding: 15px 50px; font-size: 1.5rem; background: var(--pink); 
            border: none; border-radius: 50px; color: white; cursor: pointer; box-shadow: 0 0 20px var(--pink);
        }

        /* GAME HUD */
        #hud { display: none; position: absolute; top: 10px; width: 100%; pointer-events: none; z-index: 60; }
        #scoreboard { text-align: center; font-size: 2rem; text-shadow: 2px 2px #000; }
        #pwr-meter-container { position: absolute; left: 20px; top: 10px; width: 150px; height: 15px; background: #333; border: 2px solid white; }
        #pwr-bar { width: 0%; height: 100%; background: var(--neon); box-shadow: 0 0 10px var(--neon); }

        /* CONTROLS */
        #controls { display: none; position: absolute; bottom: 0; width: 100%; height: 180px; z-index: 50; }
        #joy-base { position: absolute; bottom: 30px; left: 30px; width: 100px; height: 100px; background: rgba(255,255,255,0.1); border: 2px solid rgba(255,255,255,0.3); border-radius: 50%; }
        #joy-stick { position: absolute; top: 25px; left: 25px; width: 50px; height: 50px; background: white; border-radius: 50%; box-shadow: 0 0 15px rgba(255,255,255,0.5); }
        #act-btn { position: absolute; bottom: 40px; right: 30px; width: 85px; height: 85px; background: #444; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; border: 4px solid #666; transition: 0.2s; }
        #act-btn.ready { background: var(--pink); border-color: white; box-shadow: 0 0 20px var(--pink); color: white; }
        
        canvas { display: none; }
    </style>
</head>
<body>

<div id="menu-screen">
    <div class="header">NNSC CLASH</div>
    <div class="selection-grid" id="selectors-container"></div>
    <button id="start-btn">KICK OFF</button>
</div>

<div id="hud">
    <div id="pwr-meter-container"><div id="pwr-bar"></div></div>
    <div id="scoreboard">YOU 0 - 0 COM</div>
</div>

<div id="controls">
    <div id="joy-base"><div id="joy-stick"></div></div>
    <div id="act-btn">PWR</div>
</div>

<canvas id="gameCanvas"></canvas>

<script>
const DATA = {
    '15Goalies': { nick: 'CHRIS B', gk: 1, lb: 9, cb: 5, rb: 8, cm: 2, lw: 1, rw: 1, st: 1, pwr: 'THE ROOKIE' },
    '1300Melvin': { nick: 'MELVIN', gk: 0, lb: 0, cb: 0, rb: 0, cm: 5, lw: 9, rw: 9, st: 9, pwr: 'DEPENDENCY' },
    'angelolee1919': { nick: 'ANGELO', gk: 9, lb: 8, cb: 5, rb: 8, cm: 9, lw: 9, rw: 9, st: 9, pwr: 'DOG POWER' },
    'CheekyBritishPerson1': { nick: 'CHEEKY', gk: 1, lb: 1, cb: 1, rb: 1, cm: 5, lw: 5, rw: 5, st: 5, pwr: 'SIDHU' },
    'CristianoRonaldo9604': { nick: 'CRISTIANO', gk: 5, lb: 8, cb: 9, rb: 8, cm: 0, lw: 0, rw: 0, st: 0, pwr: 'DOG POWER' },
    'dvrianz': { nick: 'DVR', gk: 1, lb: 9, cb: 8, rb: 9, cm: 7, lw: 2, rw: 2, st: 2, pwr: 'OG PLAYER' },
    'E_Militao': { nick: 'EDER', gk: 8, lb: 9, cb: 9, rb: 9, cm: 7, lw: 2, rw: 2, st: 2, pwr: 'SHUTDOWN' },
    'ElTatoYorugua': { nick: 'LEYENDA', gk: 0, lb: 8, cb: 8, rb: 8, cm: 9, lw: 7, rw: 7, st: 7, pwr: 'MILANESA' },
    'EnesxRlo': { nick: 'ENES', gk: 2, lb: 8, cb: 7, rb: 7, cm: 7, lw: 2, rw: 2, st: 2, pwr: 'TACKLE-O-MATIC' },
    'Fafumz': { nick: 'FAF', gk: 0, lb: 7, cb: 0, rb: 7, cm: 7, lw: 5, rw: 5, st: 5, pwr: "C'EST" },
    'iHyperReal': { nick: 'ARDA', gk: 0, lb: 2, cb: 0, rb: 2, cm: 7, lw: 9, rw: 9, st: 9, pwr: 'TYPEWRITER' },
    'J0ffPerc': { nick: 'J0FF', gk: 0, lb: 9, cb: 5, rb: 9, cm: 5, lw: 0, rw: 0, st: 0, pwr: 'GYM' },
    'JellozBenz': { nick: 'JELLO', gk: 0, lb: 8.5, cb: 7, rb: 8.5, cm: 9, lw: 8, rw: 8, st: 9, pwr: 'OG PLAYER' },
    'kenenmusss': { nick: 'KAAN', gk: 7, lb: 7, cb: 7, rb: 7, cm: 9, lw: 7, rw: 7, st: 7, pwr: 'ASKIM' },
    'mageman5304': { nick: 'MAGE', gk: 0, lb: 9, cb: 9, rb: 9, cm: 5, lw: 0, rw: 0, st: 0, pwr: 'LOCKDOWN' },
    'nascarremy16': { nick: 'REMY', gk: 0, lb: 0, cb: 0, rb: 0, cm: 5, lw: 5, rw: 5, st: 5, pwr: 'INVISIBLILITY' },
    'petnilongo3': { nick: 'KAYN', gk: 0, lb: 0, cb: 0, rb: 0, cm: 9, lw: 9, rw: 9, st: 9, pwr: 'FEIJOADA' },
    'psychx777': { nick: 'PSYCH', gk: 0, lb: 0, cb: 0, rb: 0, cm: 9, lw: 9, rw: 9, st: 9, pwr: '7' },
    'Salomaoarruda': { nick: 'SALAMANCA', gk: 0, lb: 0, cb: 0, rb: 0, cm: 5, lw: 9, rw: 9, st: 9, pwr: 'EGOIST' },
    'TG37074': { nick: 'TG', gk: 9, lb: 0, cb: 0, rb: 0, cm: 0, lw: 0, rw: 0, st: 0, pwr: 'YES SAR' },
    'Tyranizard89': { nick: 'TYRAN', gk: 9, lb: 0, cb: 0, rb: 0, cm: 0, lw: 0, rw: 0, st: 0, pwr: 'DINOSAUR' }
};

const keys = Object.keys(DATA);
const positions = ["GK", "DEF", "MID", "ATT"];
let myTeam = [19, 14, 12, 18]; 
let powerCharge = 0;
let isPowerActive = false;

// UI Setup
const container = document.getElementById('selectors-container');
positions.forEach((pos, i) => {
    container.innerHTML += `<div class="slot"><h3>${pos}</h3><div class="selector">
    <button class="arrow" onclick="cycle(${i},-1)">◀</button>
    <div class="name-display" id="n-${i}">-</div>
    <button class="arrow" onclick="cycle(${i},1)">▶</button>
    </div><div class="stars" id="s-${i}"></div></div>`;
});

function cycle(s, d) {
    myTeam[s] = (myTeam[s] + d + keys.length) % keys.length;
    updateMenu();
}

function updateMenu() {
    myTeam.forEach((idx, i) => {
        const p = DATA[keys[idx]];
        document.getElementById(`n-${i}`).innerText = p.nick;
        let v = i==0?p.gk:i==1?(p.lb+p.cb+p.rb)/3:i==2?p.cm:(p.lw+p.rw+p.st)/3;
        document.getElementById(`s-${i}`).innerText = "⭐".repeat(Math.round((v/9)*5)||1);
    });
}
updateMenu();

// Engine
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
let ball = { x: 0, y: 0, vx: 0, vy: 0 };
let players = [];
let score = [0, 0];
let joy = { x: 0, y: 0, active: false };

function init() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    players = [];
    myTeam.forEach((idx, i) => {
        players.push({ t: 'u', n: DATA[keys[idx]].nick, x: 150, y: (canvas.height/5)*(i+1), cur: i==3, s: 4 });
    });
    for(let i=0; i<4; i++) {
        players.push({ t: 'c', n: 'COM', x: canvas.width-150, y: (canvas.height/5)*(i+1), cur: false, s: 3.2 });
    }
    resetBall();
}

function resetBall() {
    ball.x = canvas.width/2; ball.y = canvas.height/2;
    ball.vx = 0; ball.vy = 0;
}

// Mobile Touch
window.addEventListener('touchstart', e => {
    const t = e.touches[0];
    const b = document.getElementById('joy-base').getBoundingClientRect();
    if(t.clientX > b.left && t.clientX < b.right && t.clientY > b.top && t.clientY < b.bottom) joy.active = true;
    if(e.target.id === 'act-btn' && powerCharge >= 100) triggerPower();
});
window.addEventListener('touchmove', e => {
    if(!joy.active) return;
    const t = e.touches[0];
    const b = document.getElementById('joy-base').getBoundingClientRect();
    const cx = b.left + 50, cy = b.top + 50;
    const dx = t.clientX - cx, dy = t.clientY - cy;
    const dist = Math.min(40, Math.sqrt(dx*dx+dy*dy));
    const ang = Math.atan2(dy, dx);
    joy.x = Math.cos(ang) * (dist/40);
    joy.y = Math.sin(ang) * (dist/40);
    document.getElementById('joy-stick').style.transform = `translate(${Math.cos(ang)*dist}px, ${Math.sin(ang)*dist}px)`;
});
window.addEventListener('touchend', () => {
    joy.active = false; joy.x = 0; joy.y = 0;
    document.getElementById('joy-stick').style.transform = `translate(0,0)`;
});

function triggerPower() {
    powerCharge = 0;
    isPowerActive = true;
    const p = players.find(p => p.cur);
    p.s *= 2.5; // Double speed
    setTimeout(() => { p.s /= 2.5; isPowerActive = false; }, 3000);
}

function update() {
    ball.x += ball.vx; ball.y += ball.vy;
    ball.vx *= 0.98; ball.vy *= 0.98;
    if(ball.y < 20 || ball.y > canvas.height-20) ball.vy *= -1;
    
    if(ball.x < 0) { score[1]++; resetBall(); }
    if(ball.x > canvas.width) { score[0]++; resetBall(); }
    document.getElementById('scoreboard').innerText = `${score[0]} - ${score[1]}`;

    players.forEach(p => {
        if(p.cur) { p.x += joy.x*p.s; p.y += joy.y*p.s; }
        else {
            let dx = ball.x - p.x, dy = ball.y - p.y;
            let d = Math.sqrt(dx*dx+dy*dy);
            if(d > 5) { p.x += (dx/d)*p.s; p.y += (dy/d)*p.s; }
        }
        let dx = ball.x - p.x, dy = ball.y - p.y;
        let d = Math.sqrt(dx*dx+dy*dy);
        if(d < 25) {
            ball.vx = (dx/d) * (p.cur?10:7);
            ball.vy = (dy/d) * (p.cur?10:7);
            if(p.t == 'u' && powerCharge < 100) powerCharge += 0.5;
        }
    });
    
    const bar = document.getElementById('pwr-bar');
    bar.style.width = powerCharge + "%";
    document.getElementById('act-btn').className = powerCharge >= 100 ? 'ready' : '';
}

function draw() {
    ctx.fillStyle = '#1e4d1e'; ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.strokeStyle = 'white'; ctx.lineWidth = 2;
    ctx.strokeRect(20, 20, canvas.width-40, canvas.height-40);
    ctx.beginPath(); ctx.moveTo(canvas.width/2, 20); ctx.lineTo(canvas.width/2, canvas.height-20); ctx.stroke();
    
    // Ball
    ctx.fillStyle = 'white'; ctx.beginPath(); ctx.arc(ball.x, ball.y, 8, 0, Math.PI*2); ctx.fill();
    
    // Players
    players.forEach(p => {
        ctx.fillStyle = p.t == 'u' ? '#00d2ff' : '#ff007f';
        if(p.cur && isPowerActive) ctx.shadowBlur = 20, ctx.shadowColor = 'yellow';
        ctx.beginPath(); ctx.arc(p.x, p.y, 15, 0, Math.PI*2); ctx.fill();
        ctx.shadowBlur = 0;
        ctx.fillStyle = 'white'; ctx.font = '12px Arial'; ctx.textAlign = 'center';
        ctx.fillText(p.n, p.x, p.y - 20);
    });
}

function loop() { update(); draw(); requestAnimationFrame(loop); }

document.getElementById('start-btn').onclick = () => {
    document.getElementById('menu-screen').style.display = 'none';
    document.getElementById('controls').style.display = 'block';
    document.getElementById('hud').style.display = 'block';
    canvas.style.display = 'block';
    init(); loop();
};
</script>
</body>
</html>
